enum ReferralStatus {
  inactive
  trial
  purchased
}

model Referral {
  id         String         @id @default(uuid())
  referrerId String         @map("referrer_id")
  referredId String         @unique @map("referred_id")
  status     ReferralStatus @default(inactive)
  createdAt  DateTime       @default(now()) @map("created_at")
  updatedAt  DateTime       @updatedAt @map("updated_at")

  referrer Customer @relation("ReferralsGiven", fields: [referrerId], references: [id])
  referred Customer @relation("ReferralReceived", fields: [referredId], references: [id])

  @@unique([referrerId, referredId])
  @@index([referrerId, status, createdAt])
  @@map("referral")
}
